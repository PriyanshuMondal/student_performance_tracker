{% extends "base.html" %}
{% block content %}
  <h2>Students</h2>
  {% if students %}
    <table class="table table-striped table-bordered align-middle">
      <thead class="table-dark">
        <tr>
          <th>Name</th>
          <th>Roll Number</th>
          <th>Average</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for s in students %}
        <tr>
          <td>{{ s.name }}</td>
          <td>{{ s.roll_number }}</td>
          <td>
            {% if s.average() is not none %}
              {{ s.average() }}
            {% else %}
              <span class="text-muted">No grades</span>
            {% endif %}
          </td>
          <td>
            <a class="btn btn-sm btn-primary" href="{{ url_for('student_detail', student_id=s.id) }}">View</a>
            <form class="d-inline" action="{{ url_for('delete_student', student_id=s.id) }}" method="post" onsubmit="return confirm('Delete this student and all grades?');">
              <button class="btn btn-sm btn-danger" type="submit">Delete</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No students yet. <a class="btn btn-success" href="{{ url_for('add_student') }}">Add one</a></p>
  {% endif %}
{% endblock %}
